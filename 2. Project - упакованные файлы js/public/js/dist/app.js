(()=>{var t={848:()=>{Vue.component("cart",{data:()=>({cartUrl:"/getBasket.json",cartItems:[],imgCart:"img/photo/featured/mini/",showCart:!1,totalSum:0}),mounted(){this.$parent.getJson("/api/cart").then((t=>{for(let e of t.contents)this.$data.cartItems.push(e)})).catch((t=>{this.$root.$refs.error.text=t}))},methods:{addProduct(t){let e=this.cartItems.find((e=>e.id_product===t.id_product));if(e)this.$parent.putJson(`/api/cart/${e.id_product}`,{quantity:1}).then((t=>{1===t.result&&e.quantity++}));else{const e=Object.assign({quantity:1},t);this.$parent.postJson("/api/cart",e).then((t=>{1===t.result&&this.cartItems.push(e)})).catch((t=>{this.$root.$refs.error.text=t}))}},remove(t){let e=this.cartItems.find((e=>e.id_product===t.id_product));this.$root.remove(`/api/cart/${t.id_product}`,e),this.$parent.getJson("https://raw.githubusercontent.com/GeekBrainsTutorial/online-store-api/master/responses/addToBasket.json").then((e=>{1===e.result&&(t.quantity>1?t.quantity--:this.cartItems.splice(this.cartItems.indexOf(t),1))}))},getTotalSum(){let t=0;this.cartItems.forEach((e=>{t+=e.quantity*e.price})),this.totalSum=t},getTotalSumMinus(t){this.totalSum-=t.price},getTotalSumPlus(t){this.totalSum+=t.price}},template:'<div class="cartBtn"><a class="cartBtn-img" href="#"><i class="fas fa-shopping-cart" @click=\'[showCart = !showCart,getTotalSum()]\'></i></a>\n                    <div class="cartBtn-menu" v-show="showCart">\n                           <cart-item v-for="item of cartItems" :key="item.id_product" :img="imgCart" :cart-item="item" @remove="remove" @getTotalSumPlus="getTotalSumPlus" @getTotalSumMinus="getTotalSumMinus" @addProduct="addProduct"></cart-item>\n                           <div class="cartBtn-menu__total">\n                               <span class="cartBtn-menu__total-text">TOTAL</span>\n                               <span class="cartBtn-menu__total-price">{{this.totalSum}} $</span>\n                           </div>\n                           <div class="cartBtn-menu__btns-block">\n                                    <a href="checkout.html" class="cartBtn-menu__button">Checkout</a>\n                                    <a href="shopping-cart.html" class="cartBtn-menu__button">Go to cart</a>\n                           </div>\n                    </div>\n               </div>\n    '}),Vue.component("cart-item",{props:["img","cartItem"],template:'<div class="cartBtn-menu__product">\n                       <a href="single_page.html" class="cartBtn-menu__product-link"><img class="cartBtn-menu__product-img" :src="img+cartItem.id_product+\'.jpg\'" :alt="\'id-\'+cartItem.id_product"></a>\n                        <div class="cartBtn-menu__product-info">\n                            <h3 class="cartBtn-menu__product-name">{{ cartItem.product_name }}</h3>\n                            <img src="img/photo/cart-btn/cartBtn_stars.png" alt="4.5 stars" class="cartBtn-menu__product-stars">\n                            <p class="cartBtn-menu__product-price"><button class="cart-increase-number" @click="[$emit(\'addProduct\', cartItem), $emit(\'getTotalSumPlus\', cartItem)]"><i class="fas fa-arrow-up"></i></button> {{ cartItem.quantity }} <span>x</span> {{ cartItem.price }}$ <span>=</span> {{cartItem.quantity*cartItem.price}}$</p>\n                        </div>\n                       <button class="cart-delete-btn" @click="[$emit(\'remove\', cartItem), $emit(\'getTotalSumMinus\', cartItem)]"><i class="fas fa-times-circle"></i></button> \n               </div>\n    '})},772:()=>{Vue.component("error",{data:()=>({text:""}),computed:{isVisible(){return""!==this.text}},template:'\n    <div class="error-block" v-if="isVisible">\n        <p class="error-msg">\n        <button class="close-btn" @click="text=\'\'">&times;</button>\n        {{ text }}\n</p>\n</div>\n    '})},695:()=>{Vue.component("filter-el",{data:()=>({userSearch:""}),template:'<form action="#" class="header__form" @submit.prevent="$parent.$refs.products.filter(userSearch)">\n                    <label>\n                        <input type="text" placeholder="Search for Item..." v-model="userSearch">\n                    </label>\n                    <button type="submit"><i class="fas fa-search"></i></button>\n            </form>'})},451:()=>{Vue.component("products",{data:()=>({filtered:[],products:[],imgProduct:"img/photo/featured/"}),mounted(){this.$parent.getJson("/api/products").then((t=>{for(let e of t)this.$data.products.push(e),this.$data.filtered.push(e)}))},methods:{filter(t){let e=new RegExp(t,"i");this.filtered=this.products.filter((t=>e.test(t.product_name)))}},template:'<div class="featured__items">\n                <product v-for="item of filtered" \n                :key="item.id_product" \n                :img="imgProduct"\n                :product="item"\n                @add-product="$parent.$refs.cart.addProduct"\n                @getTotalSumCartPlus="$parent.$refs.cart.getTotalSumPlus"></product>\n              </div>'}),Vue.component("product",{props:["product","img"],template:'\n             <div class="featured__items_block">\n                    <a href="single_page.html" class="featured__items_link">\n                        <img :src="img+product.id_product+\'.jpg\'" :alt="\'id-\'+product.id_product">\n                        <p class="featured__items_text">{{product.product_name}}</p>\n                        <p class="featured__items_price">{{product.price}}$</p>\n                    </a>\n                    <div class="featured__add">\n                        <button class="featured__add_btn" @click="[$emit(\'add-product\', product), $emit(\'getTotalSumCartPlus\', product)]">\n                            <i class="fas fa-shopping-cart"></i>\n                            Add to Cart\n                        </button>\n                    </div>\n             </div>\n    '})}},e={};function r(a){var s=e[a];if(void 0!==s)return s.exports;var n=e[a]={exports:{}};return t[a](n,n.exports,r),n.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";r(848),r(772),r(695),r(451),new Vue({el:"#app",data:{userSearch:""},methods:{fetchProducts(t){return fetch(t).then((t=>t.json())).catch((t=>{this.$refs.error.text=t}))},getJson(t){return fetch(t).then((t=>t.json())).catch((t=>{this.$refs.error.text=t}))},postJson(t,e){return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>t.json())).catch((t=>{this.$refs.error.text=t}))},putJson(t,e){return fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>t.json())).catch((t=>{this.$refs.error.text=t}))},remove(t,e){return fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>{t.json(),this.fetchProducts("/api/cart")})).catch((t=>{this.$refs.error.text=t}))}},mounted(){}})})()})();